<?xml version="1.0" encoding="UTF-8"?>
<!--
  Copyright 2015-2019 ForgeRock AS. All Rights Reserved
 
  Use of this code requires a commercial software license with ForgeRock AS.
  or with one of its affiliates. All use shall be exclusively subject
  to such license between the licensee and ForgeRock AS.
-->
<!DOCTYPE ServicesConfiguration
    PUBLIC "=//iPlanet//Service Management Services (SMS) 1.0 DTD//EN" "jar://com/sun/identity/sm/sms.dtd">

<ServicesConfiguration>
    <Service name="ScriptingService" version="1.0">

        <Schema serviceHierarchy="/DSAMEConfig/ScriptingService"
                i18nFileName="scripting"
                revisionNumber="1"
                i18nKey="service-description"
                resourceName="scripting">
            <Global>
                <AttributeSchema name="defaultScriptContext" i18nKey="g101" order="900" type="single_choice"
                                 resourceName="defaultContext">
                    <ChoiceValues>
                        <ChoiceValue i18nKey="script-type-01">POLICY_CONDITION</ChoiceValue>
                        <ChoiceValue i18nKey="script-type-02">AUTHENTICATION_SERVER_SIDE</ChoiceValue>
                        <ChoiceValue i18nKey="script-type-03">AUTHENTICATION_CLIENT_SIDE</ChoiceValue>
                        <ChoiceValue i18nKey="script-type-04">OIDC_CLAIMS</ChoiceValue>
                        <ChoiceValue i18nKey="script-type-05">AUTHENTICATION_TREE_DECISION_NODE</ChoiceValue>
                        <ChoiceValue i18nKey="script-type-06">OAUTH2_ACCESS_TOKEN_MODIFICATION</ChoiceValue>
                    </ChoiceValues>
                    <DefaultValues>
                        <Value>POLICY_CONDITION</Value>
                    </DefaultValues>
                </AttributeSchema>
                <SubSchema name="scriptContext" inheritance="multiple" resourceName="contexts">
                    <AttributeSchema name="i18nKey" type="single"/>
                    <AttributeSchema name="languages" type="multiple_choice" syntax="string" i18nKey="st101" order="1100">
                        <ChoiceValues>
                            <ChoiceValue i18nKey="language-01">JAVASCRIPT</ChoiceValue>
                            <ChoiceValue i18nKey="language-02">GROOVY</ChoiceValue>
                        </ChoiceValues>
                        <DefaultValues>
                            <Value>JAVASCRIPT</Value>
                            <Value>GROOVY</Value>
                        </DefaultValues>
                    </AttributeSchema>
                    <AttributeSchema name="defaultScript" type="single_choice" uitype="globalScriptSelect"
                                     propertiesViewBeanURL="../ui-admin/%23realms/{0}/scripts/edit/{1}" syntax="string"
                                     i18nKey="st103"
                                     order="1200">
                        <ChoiceValues>
                            <ChoiceValuesClassName
                                    className="org.forgerock.openam.scripting.service.ScriptChoiceValues">
                                <AttributeValuePair>
                                    <Attribute name="GlobalOnly"/>
                                    <Value>true</Value>
                                </AttributeValuePair>
                            </ChoiceValuesClassName>
                        </ChoiceValues>
                    </AttributeSchema>
                    <SubSchema name="engineConfiguration" i18nKey="ec100">
                        <AttributeSchema name="i18nKey" type="single">
                            <DefaultValues>
                                <Value>engine-configuration</Value>
                            </DefaultValues>
                        </AttributeSchema>
                        <AttributeSchema name="serverTimeout"
                                         type="single" syntax="number_range" rangeStart="0"
                                         rangeEnd="2147483647" i18nKey="ec101" order="100">
                            <DefaultValues>
                                <Value>0</Value>
                            </DefaultValues>
                        </AttributeSchema>
                        <AttributeSchema name="coreThreads"
                                         type="single" syntax="number_range" rangeStart="1"
                                         rangeEnd="2147483647" i18nKey="ec102" order="200">
                            <DefaultValues>
                                <Value>10</Value>
                            </DefaultValues>
                        </AttributeSchema>
                        <AttributeSchema name="maxThreads"
                                         type="single" syntax="number_range" rangeStart="1"
                                         rangeEnd="2147483647" i18nKey="ec103" order="300">
                            <DefaultValues>
                                <Value>50</Value>
                            </DefaultValues>
                        </AttributeSchema>
                        <AttributeSchema name="queueSize"
                                         type="single" syntax="number_range" rangeStart="-1"
                                         rangeEnd="2147483647" i18nKey="ec104" order="400">
                            <DefaultValues>
                                <Value>10</Value>
                            </DefaultValues>
                        </AttributeSchema>
                        <AttributeSchema name="idleTimeout"
                                         type="single" syntax="number_range" rangeStart="0"
                                         rangeEnd="2147483647" i18nKey="ec105" order="500">
                            <DefaultValues>
                                <Value>60</Value>
                            </DefaultValues>
                        </AttributeSchema>
                        <AttributeSchema name="whiteList"
                                         type="list" syntax="string" i18nKey="ec106" order="600">
                            <DefaultValues>
                                <Value>java.lang.Boolean</Value>
                                <Value>java.lang.Byte</Value>
                                <Value>java.lang.Character</Value>
                                <Value>java.lang.Character$Subset</Value>
                                <Value>java.lang.Character$UnicodeBlock</Value>
                                <Value>java.lang.Double</Value>
                                <Value>java.lang.Float</Value>
                                <Value>java.lang.Integer</Value>
                                <Value>java.lang.Long</Value>
                                <Value>java.lang.Math</Value>
                                <Value>java.lang.Number</Value>
                                <Value>java.lang.Object</Value>
                                <Value>java.lang.Short</Value>
                                <Value>java.lang.StrictMath</Value>
                                <Value>java.lang.String</Value>
                                <Value>java.lang.Void</Value>
                                <Value>java.util.ArrayList</Value>
                                <Value>java.util.HashSet</Value>
                                <Value>java.util.HashMap</Value>
                                <Value>java.util.HashMap$KeyIterator</Value>
                                <Value>java.util.LinkedHashMap</Value>
                                <Value>java.util.LinkedHashSet</Value>
                                <Value>java.util.LinkedList</Value>
                                <Value>java.util.TreeMap</Value>
                                <Value>java.util.TreeSet</Value>
                                <Value>com.sun.identity.shared.debug.Debug</Value>
                                <Value>org.codehaus.groovy.runtime.GStringImpl</Value>
                                <Value>org.codehaus.groovy.runtime.ScriptBytecodeAdapter</Value>
                                <Value>org.forgerock.http.client.*</Value>
                                <Value>org.forgerock.http.Client</Value>
                                <Value>org.forgerock.http.Handler</Value>
                                <Value>org.forgerock.http.Context</Value>
                                <Value>org.forgerock.http.context.RootContext</Value>
                                <Value>java.util.Collections$EmptyList</Value>
                                <Value>org.forgerock.http.protocol.Entity</Value>
                                <Value>org.forgerock.http.protocol.Form</Value>
                                <Value>org.forgerock.http.protocol.Header</Value>
                                <Value>org.forgerock.http.protocol.Headers</Value>
                                <Value>org.forgerock.http.protocol.Message</Value>
                                <Value>org.forgerock.http.protocol.Request</Value>
                                <Value>org.forgerock.http.protocol.RequestCookies</Value>
                                <Value>org.forgerock.http.protocol.Response</Value>
                                <Value>org.forgerock.http.protocol.ResponseException</Value>
                                <Value>org.forgerock.http.protocol.Responses</Value>
                                <Value>org.forgerock.http.protocol.Status</Value>
                                <Value>org.forgerock.util.promise.NeverThrowsException</Value>
                                <Value>org.forgerock.util.promise.Promise</Value>
                                <Value>org.forgerock.util.promise.PromiseImpl</Value>
                                <Value>org.forgerock.openam.scripting.api.http.GroovyHttpClient</Value>
                                <Value>org.forgerock.openam.scripting.api.http.JavaScriptHttpClient</Value>
                                <Value>org.forgerock.openam.scripting.api.ScriptedIdentity</Value>
                                <Value>org.forgerock.openam.scripting.api.ScriptedSession</Value>
                                <Value>groovy.json.JsonSlurper</Value>
                            </DefaultValues>
                        </AttributeSchema>
                        <AttributeSchema name="blackList"
                                         type="list" syntax="string" i18nKey="ec107" order="700">
                            <DefaultValues>
                                <Value>java.security.AccessController</Value>
                                <Value>java.lang.Class</Value>
                                <Value>java.lang.reflect.*</Value>
                            </DefaultValues>
                        </AttributeSchema>
                        <AttributeSchema name="useSecurityManager"
                                         type="single" syntax="boolean" i18nKey="ec108" order="800">
                            <BooleanValues>
                                <BooleanTrueValue i18nKey="i18nTrue">true</BooleanTrueValue>
                                <BooleanFalseValue i18nKey="i18nFalse">false</BooleanFalseValue>
                            </BooleanValues>
                            <DefaultValues>
                                <Value>true</Value>
                            </DefaultValues>
                        </AttributeSchema>
                    </SubSchema>
                </SubSchema>
                <SubSchema name="globalScripts" hideConfigUI="yes" resourceName="USE-PARENT">
                    <SubSchema name="globalScript" hideConfigUI="yes" inheritance="multiple">
                        <AttributeSchema name="name" type="single" syntax="string" i18nKey="script.name"/>
                        <AttributeSchema name="description" type="single" syntax="string" i18nKey="script.description"/>
                        <AttributeSchema name="context" type="single" syntax="string" i18nKey="script.type"/>
                        <AttributeSchema name="language" type="single" i18nKey="script.language">
                            <DefaultValues>
                                <Value>JAVASCRIPT</Value>
                            </DefaultValues>
                        </AttributeSchema>
                        <AttributeSchema name="script" type="single" syntax="script" i18nKey="script.content"/>
                        <AttributeSchema name="createdBy" type="single" syntax="string" i18nKey="script.createdBy">
                            <DefaultValues>
                                <Value>id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org</Value>
                            </DefaultValues>
                        </AttributeSchema>
                        <AttributeSchema name="creationDate" type="single" syntax="string" i18nKey="script.creationDate">
                            <DefaultValues>
                                <Value>1433147666269</Value>
                            </DefaultValues>
                        </AttributeSchema>
                        <AttributeSchema name="lastModifiedBy" type="single" syntax="string" i18nKey="script.lastModifiedBy">
                            <DefaultValues>
                                <Value>id=dsameuser,ou=user,dc=openam,dc=forgerock,dc=org</Value>
                            </DefaultValues>
                        </AttributeSchema>
                        <AttributeSchema name="lastModifiedDate" type="single" syntax="string" i18nKey="script.lastModifiedDate">
                            <DefaultValues>
                                <Value>1433147666269</Value>
                            </DefaultValues>
                        </AttributeSchema>
                    </SubSchema>
                </SubSchema>
            </Global>
            <Organization>
                <SubSchema name="scriptConfigurations" resourceName="EMPTY">
                    <SubSchema name="scriptConfiguration" inheritance="multiple" resourceName="scripts"
                               hideConfigUI="yes">
                        <AttributeSchema name="name" type="single" syntax="string" i18nKey="script.name" order="1000"/>
                        <AttributeSchema name="description" type="single" syntax="string" i18nKey="script.description" order="1000"/>
                        <AttributeSchema name="script" type="single" syntax="script" i18nKey="script.content" order="1000"/>
                        <AttributeSchema name="language" type="single" syntax="string" i18nKey="script.language" order="1000">
                            <ChoiceValues>
                                <ChoiceValue i18nKey="language-01">JAVASCRIPT</ChoiceValue>
                                <ChoiceValue i18nKey="language-02">GROOVY</ChoiceValue>
                            </ChoiceValues>
                        </AttributeSchema>
                        <AttributeSchema name="context" type="single_choice" syntax="string" i18nKey="script.type" order="1000">
                            <ChoiceValues>
                                <ChoiceValue i18nKey="script-type-01">POLICY_CONDITION</ChoiceValue>
                                <ChoiceValue i18nKey="script-type-02">AUTHENTICATION_SERVER_SIDE</ChoiceValue>
                                <ChoiceValue i18nKey="script-type-03">AUTHENTICATION_CLIENT_SIDE</ChoiceValue>
                                <ChoiceValue i18nKey="script-type-04">OIDC_CLAIMS</ChoiceValue>
                                <ChoiceValue i18nKey="script-type-05">AUTHENTICATION_TREE_DECISION_NODE</ChoiceValue>
                                <ChoiceValue i18nKey="script-type-06">OAUTH2_ACCESS_TOKEN_MODIFICATION</ChoiceValue>
                            </ChoiceValues>
                        </AttributeSchema>
                        <AttributeSchema name="createdBy" type="single" syntax="string" i18nKey="script.createdBy" order="1000"/>
                        <AttributeSchema name="creationDate" type="single" syntax="string" i18nKey="script.creationDate" order="1000"/>
                        <AttributeSchema name="lastModifiedBy" type="single" syntax="string" i18nKey="script.lastModifiedBy" order="1000"/>
                        <AttributeSchema name="lastModifiedDate" type="single" syntax="string" i18nKey="script.lastModifiedDate" order="1000"/>
                    </SubSchema>
                </SubSchema>
            </Organization>
        </Schema>

        <Configuration>
            <GlobalConfiguration>
                <SubConfiguration name="POLICY_CONDITION" id="scriptContext">
                    <AttributeValuePair>
                        <Attribute name="i18nKey"/>
                        <Value>script-type-01</Value>
                    </AttributeValuePair>
                    <AttributeValuePair>
                        <Attribute name="defaultScript"/>
                        <Value>9de3eb62-f131-4fac-a294-7bd170fd4acb</Value>
                    </AttributeValuePair>
                    <SubConfiguration name="engineConfiguration" id="engineConfiguration"/>
                </SubConfiguration>
                <SubConfiguration name="AUTHENTICATION_SERVER_SIDE" id="scriptContext">
                    <AttributeValuePair>
                        <Attribute name="i18nKey"/>
                        <Value>script-type-02</Value>
                    </AttributeValuePair>
                    <AttributeValuePair>
                        <Attribute name="defaultScript"/>
                        <Value>7e3d7067-d50f-4674-8c76-a3e13a810c33</Value>
                    </AttributeValuePair>
                    <SubConfiguration name="engineConfiguration" id="engineConfiguration">
                        <AttributeValuePair>
                            <Attribute name="whiteList"/>
                            <Value>java.lang.Boolean</Value>
                            <Value>java.lang.Byte</Value>
                            <Value>java.lang.Character</Value>
                            <Value>java.lang.Character$Subset</Value>
                            <Value>java.lang.Character$UnicodeBlock</Value>
                            <Value>java.lang.Double</Value>
                            <Value>java.lang.Float</Value>
                            <Value>java.lang.Integer</Value>
                            <Value>java.lang.Long</Value>
                            <Value>java.lang.Math</Value>
                            <Value>java.lang.Number</Value>
                            <Value>java.lang.Object</Value>
                            <Value>java.lang.Short</Value>
                            <Value>java.lang.StrictMath</Value>
                            <Value>java.lang.String</Value>
                            <Value>java.lang.Void</Value>
                            <Value>java.util.ArrayList</Value>
                            <Value>java.util.ArrayList$Itr</Value>
                            <Value>java.util.HashSet</Value>
                            <Value>java.util.HashMap</Value>
                            <Value>java.util.HashMap$KeyIterator</Value>
                            <Value>java.util.LinkedHashMap</Value>
                            <Value>java.util.LinkedHashSet</Value>
                            <Value>java.util.LinkedList</Value>
                            <Value>java.util.TreeMap</Value>
                            <Value>java.util.TreeSet</Value>
                            <Value>com.sun.identity.shared.debug.Debug</Value>
                            <Value>org.codehaus.groovy.runtime.GStringImpl</Value>
                            <Value>org.codehaus.groovy.runtime.ScriptBytecodeAdapter</Value>
                            <Value>org.forgerock.openam.core.rest.devices.deviceprint.DeviceIdDao</Value>
                            <Value>org.forgerock.openam.authentication.modules.scripted.*</Value>
                            <Value>org.forgerock.openam.scripting.api.http.GroovyHttpClient</Value>
                            <Value>org.forgerock.openam.scripting.api.http.JavaScriptHttpClient</Value>
                            <Value>org.forgerock.openam.scripting.api.ScriptedIdentity</Value>
                            <Value>org.forgerock.openam.scripting.api.ScriptedSession</Value>
                            <Value>org.forgerock.http.client.*</Value>
                            <Value>groovy.json.JsonSlurper</Value>
                            <Value>org.forgerock.http.protocol.Cookie</Value>
                            <Value>org.forgerock.http.protocol.Entity</Value>
                            <Value>org.forgerock.http.protocol.Form</Value>
                            <Value>org.forgerock.http.protocol.Header</Value>
                            <Value>org.forgerock.http.protocol.Headers</Value>
                            <Value>org.forgerock.http.protocol.Message</Value>
                            <Value>org.forgerock.http.protocol.Request</Value>
                            <Value>org.forgerock.http.protocol.RequestCookies</Value>
                            <Value>org.forgerock.http.protocol.Response</Value>
                            <Value>org.forgerock.http.protocol.ResponseException</Value>
                            <Value>org.forgerock.http.protocol.Responses</Value>
                            <Value>org.forgerock.http.protocol.Status</Value>
                            <Value>org.forgerock.json.JsonValue</Value>
                            <Value>org.forgerock.util.promise.NeverThrowsException</Value>
                            <Value>org.forgerock.util.promise.Promise</Value>
                            <Value>org.forgerock.util.promise.PromiseImpl</Value>
                        </AttributeValuePair>
                    </SubConfiguration>
                </SubConfiguration>
                <SubConfiguration name="AUTHENTICATION_CLIENT_SIDE" id="scriptContext">
                    <AttributeValuePair>
                        <Attribute name="i18nKey"/>
                        <Value>script-type-03</Value>
                    </AttributeValuePair>
                    <AttributeValuePair>
                        <Attribute name="languages"/>
                        <Value>JAVASCRIPT</Value>
                    </AttributeValuePair>
                    <AttributeValuePair>
                        <Attribute name="defaultScript"/>
                        <Value>[Empty]</Value>
                    </AttributeValuePair>
                </SubConfiguration>
                <SubConfiguration name="OIDC_CLAIMS" id="scriptContext">
                    <AttributeValuePair>
                        <Attribute name="i18nKey"/>
                        <Value>script-type-04</Value>
                    </AttributeValuePair>
                    <AttributeValuePair>
                        <Attribute name="defaultScript"/>
                        <Value>36863ffb-40ec-48b9-94b1-9a99f71cc3b5</Value>
                    </AttributeValuePair>
                    <SubConfiguration name="engineConfiguration" id="engineConfiguration">
                        <AttributeValuePair>
                            <Attribute name="whiteList"/>
                            <Value>java.lang.Boolean</Value>
                            <Value>java.lang.Byte</Value>
                            <Value>java.lang.Character</Value>
                            <Value>java.lang.Character$Subset</Value>
                            <Value>java.lang.Character$UnicodeBlock</Value>
                            <Value>java.lang.Double</Value>
                            <Value>java.lang.Float</Value>
                            <Value>java.lang.Integer</Value>
                            <Value>java.lang.Long</Value>
                            <Value>java.lang.Math</Value>
                            <Value>java.lang.Number</Value>
                            <Value>java.lang.Object</Value>
                            <Value>java.lang.Short</Value>
                            <Value>java.lang.StrictMath</Value>
                            <Value>java.lang.String</Value>
                            <Value>java.lang.Void</Value>
                            <Value>java.util.ArrayList</Value>
                            <Value>java.util.ArrayList$Itr</Value>
                            <Value>java.util.HashSet</Value>
                            <Value>java.util.HashMap</Value>
                            <Value>java.util.HashMap$Entry</Value>
                            <Value>java.util.HashMap$KeyIterator</Value>
                            <Value>java.util.LinkedHashMap$LinkedEntryIterator</Value>
                            <Value>java.util.LinkedHashMap</Value>
                            <Value>java.util.LinkedHashSet</Value>
                            <Value>java.util.LinkedList</Value>
                            <Value>java.util.TreeMap</Value>
                            <Value>java.util.Collections$SingletonList</Value>
                            <Value>java.util.TreeSet</Value>
                            <Value>org.forgerock.oauth2.core.exceptions.InvalidRequestException</Value>
                            <Value>org.forgerock.openidconnect.Claim</Value>
                            <Value>com.sun.identity.shared.debug.Debug</Value>
                            <Value>com.iplanet.sso.providers.dpro.SessionSsoToken</Value>
                            <Value>java.util.Collections$1</Value>
                            <Value>java.util.Collections$EmptyList</Value>
                            <Value>org.forgerock.http.client.*</Value>
                            <Value>groovy.json.JsonSlurper</Value>
                            <Value>com.sun.identity.idm.AMIdentity</Value>
                            <Value>java.util.LinkedHashMap$Entry</Value>
                            <Value>java.util.LinkedHashMap$LinkedEntrySet</Value>
                            <Value>org.forgerock.openam.oauth2.OpenAMAccessToken</Value>
                            <Value>java.util.HashMap$Node</Value>
                            <Value>org.forgerock.oauth2.core.UserInfoClaims</Value>
                            <Value>org.codehaus.groovy.runtime.GStringImpl</Value>
                            <Value>org.codehaus.groovy.runtime.ScriptBytecodeAdapter</Value>
                            <Value>org.forgerock.openidconnect.ssoprovider.OpenIdConnectSSOToken</Value>
                            <Value>org.forgerock.http.protocol.Request</Value>
                            <Value>org.forgerock.openam.scripting.api.http.GroovyHttpClient</Value>
                            <Value>org.forgerock.openam.scripting.api.http.JavaScriptHttpClient</Value>
                            <Value>org.forgerock.util.promise.PromiseImpl</Value>
                            <Value>org.forgerock.http.protocol.Response</Value>
                            <Value>org.forgerock.http.protocol.Entity</Value>
                        </AttributeValuePair>
                    </SubConfiguration>
                </SubConfiguration>
                <SubConfiguration name="AUTHENTICATION_TREE_DECISION_NODE" id="scriptContext">
                    <AttributeValuePair>
                        <Attribute name="i18nKey"/>
                        <Value>script-type-05</Value>
                    </AttributeValuePair>
                    <AttributeValuePair>
                        <Attribute name="defaultScript"/>
                        <Value>01e1a3c0-038b-4c16-956a-6c9d89328cff</Value>
                    </AttributeValuePair>
                    <SubConfiguration name="engineConfiguration" id="engineConfiguration">
                        <AttributeValuePair>
                            <Attribute name="whiteList"/>
                            <Value>java.lang.Boolean</Value>
                            <Value>java.lang.Byte</Value>
                            <Value>java.lang.Character</Value>
                            <Value>java.lang.Character$Subset</Value>
                            <Value>java.lang.Character$UnicodeBlock</Value>
                            <Value>java.lang.Double</Value>
                            <Value>java.lang.Float</Value>
                            <Value>java.lang.Integer</Value>
                            <Value>java.lang.Long</Value>
                            <Value>java.lang.Math</Value>
                            <Value>java.lang.Number</Value>
                            <Value>java.lang.Object</Value>
                            <Value>java.lang.Short</Value>
                            <Value>java.lang.StrictMath</Value>
                            <Value>java.lang.String</Value>
                            <Value>java.lang.Void</Value>
                            <Value>java.util.AbstractMap$*</Value>
                            <Value>java.util.ArrayList</Value>
                            <Value>java.util.Collections</Value>
                            <Value>java.util.Collections$*</Value>
                            <Value>java.util.HashSet</Value>
                            <Value>java.util.HashMap</Value>
                            <Value>java.util.HashMap$KeyIterator</Value>
                            <Value>java.util.LinkedHashMap</Value>
                            <Value>java.util.LinkedHashSet</Value>
                            <Value>java.util.LinkedList</Value>
                            <Value>java.util.TreeMap</Value>
                            <Value>java.util.TreeSet</Value>
                            <Value>javax.security.auth.callback.NameCallback</Value>
                            <Value>javax.security.auth.callback.PasswordCallback</Value>
                            <Value>javax.security.auth.callback.ChoiceCallback</Value>
                            <Value>javax.security.auth.callback.ConfirmationCallback</Value>
                            <Value>javax.security.auth.callback.LanguageCallback</Value>
                            <Value>javax.security.auth.callback.TextInputCallback</Value>
                            <Value>javax.security.auth.callback.TextOutputCallback</Value>
                            <Value>com.sun.identity.authentication.callbacks.HiddenValueCallback</Value>
                            <Value>com.sun.identity.authentication.callbacks.ScriptTextOutputCallback</Value>
                            <Value>com.sun.identity.authentication.spi.HttpCallback</Value>
                            <Value>com.sun.identity.authentication.spi.MetadataCallback</Value>
                            <Value>com.sun.identity.authentication.spi.RedirectCallback</Value>
                            <Value>com.sun.identity.authentication.spi.X509CertificateCallback</Value>
                            <Value>com.sun.identity.shared.debug.Debug</Value>
                            <Value>org.codehaus.groovy.runtime.GStringImpl</Value>
                            <Value>org.codehaus.groovy.runtime.ScriptBytecodeAdapter</Value>
                            <Value>org.forgerock.http.client.*</Value>
                            <Value>org.forgerock.http.Client</Value>
                            <Value>org.forgerock.http.Handler</Value>
                            <Value>org.forgerock.http.Context</Value>
                            <Value>org.forgerock.http.context.RootContext</Value>
                            <Value>org.forgerock.http.protocol.Cookie</Value>
                            <Value>org.forgerock.http.protocol.Entity</Value>
                            <Value>org.forgerock.http.protocol.Form</Value>
                            <Value>org.forgerock.http.protocol.Header</Value>
                            <Value>org.forgerock.http.protocol.Headers</Value>
                            <Value>org.forgerock.http.protocol.Message</Value>
                            <Value>org.forgerock.http.protocol.Request</Value>
                            <Value>org.forgerock.http.protocol.RequestCookies</Value>
                            <Value>org.forgerock.http.protocol.Response</Value>
                            <Value>org.forgerock.http.protocol.ResponseException</Value>
                            <Value>org.forgerock.http.protocol.Responses</Value>
                            <Value>org.forgerock.http.protocol.Status</Value>
                            <Value>org.forgerock.json.JsonValue</Value>
                            <Value>org.forgerock.util.promise.NeverThrowsException</Value>
                            <Value>org.forgerock.util.promise.Promise</Value>
                            <Value>org.forgerock.util.promise.PromiseImpl</Value>
                            <Value>org.forgerock.openam.auth.node.api.Action</Value>
                            <Value>org.forgerock.openam.auth.node.api.Action$ActionBuilder</Value>
                            <Value>org.forgerock.openam.authentication.callbacks.PollingWaitCallback</Value>
                            <Value>org.forgerock.openam.core.rest.authn.callbackhandlers.*</Value>
                            <Value>org.forgerock.openam.scripting.api.http.GroovyHttpClient</Value>
                            <Value>org.forgerock.openam.scripting.api.http.JavaScriptHttpClient</Value>
                            <Value>org.forgerock.openam.scripting.api.ScriptedIdentity</Value>
                            <Value>org.forgerock.openam.scripting.api.ScriptedSession</Value>
                            <Value>groovy.json.JsonSlurper</Value>
                        </AttributeValuePair>
                    </SubConfiguration>
                </SubConfiguration>
                <SubConfiguration name="OAUTH2_ACCESS_TOKEN_MODIFICATION" id="scriptContext">
                    <AttributeValuePair>
                        <Attribute name="i18nKey"/>
                        <Value>script-type-06</Value>
                    </AttributeValuePair>
                    <AttributeValuePair>
                        <Attribute name="defaultScript"/>
                        <Value>d22f9a0c-426a-4466-b95e-d0f125b0d5fa</Value>
                    </AttributeValuePair>
                    <SubConfiguration name="engineConfiguration" id="engineConfiguration">
                        <AttributeValuePair>
                            <Attribute name="whiteList"/>
                            <Value>java.lang.Boolean</Value>
                            <Value>java.lang.Byte</Value>
                            <Value>java.lang.Character</Value>
                            <Value>java.lang.Character$Subset</Value>
                            <Value>java.lang.Character$UnicodeBlock</Value>
                            <Value>java.lang.Double</Value>
                            <Value>java.lang.Float</Value>
                            <Value>java.lang.Integer</Value>
                            <Value>java.lang.Long</Value>
                            <Value>java.lang.Math</Value>
                            <Value>java.lang.Number</Value>
                            <Value>java.lang.Object</Value>
                            <Value>java.lang.Short</Value>
                            <Value>java.lang.StrictMath</Value>
                            <Value>java.lang.String</Value>
                            <Value>java.lang.Void</Value>
                            <Value>java.util.ArrayList</Value>
                            <Value>java.util.ArrayList$Itr</Value>
                            <Value>java.util.Collections$1</Value>
                            <Value>java.util.Collections$EmptyList</Value>
                            <Value>java.util.Collections$SingletonList</Value>
                            <Value>java.util.HashMap</Value>
                            <Value>java.util.HashMap$Entry</Value>
                            <Value>java.util.HashMap$KeyIterator</Value>
                            <Value>java.util.HashMap$Node</Value>
                            <Value>java.util.HashSet</Value>
                            <Value>java.util.LinkedHashMap</Value>
                            <Value>java.util.LinkedHashMap$Entry</Value>
                            <Value>java.util.LinkedHashMap$LinkedEntryIterator</Value>
                            <Value>java.util.LinkedHashMap$LinkedEntrySet</Value>
                            <Value>java.util.LinkedHashSet</Value>
                            <Value>java.util.LinkedList</Value>
                            <Value>java.util.TreeMap</Value>
                            <Value>java.util.TreeSet</Value>
                            <Value>com.iplanet.sso.providers.dpro.SessionSsoToken</Value>
                            <Value>com.sun.identity.idm.AMIdentity</Value>
                            <Value>com.sun.identity.shared.debug.Debug</Value>
                            <Value>org.codehaus.groovy.runtime.GStringImpl</Value>
                            <Value>org.codehaus.groovy.runtime.ScriptBytecodeAdapter</Value>
                            <Value>groovy.json.JsonSlurper</Value>
                            <Value>org.forgerock.http.client.*</Value>
                            <Value>org.forgerock.http.protocol.Entity</Value>
                            <Value>org.forgerock.http.protocol.Request</Value>
                            <Value>org.forgerock.http.protocol.Response</Value>
                            <Value>org.forgerock.util.promise.PromiseImpl</Value>
                            <Value>org.forgerock.oauth2.core.UserInfoClaims</Value>
                            <Value>org.forgerock.oauth2.core.exceptions.InvalidRequestException</Value>
                            <Value>org.forgerock.openam.oauth2.OpenAMAccessToken</Value>
                            <Value>org.forgerock.openidconnect.Claim</Value>
                            <Value>org.forgerock.openidconnect.ssoprovider.OpenIdConnectSSOToken</Value>
                            <Value>org.forgerock.openam.scripting.api.http.GroovyHttpClient</Value>
                            <Value>org.forgerock.openam.scripting.api.http.JavaScriptHttpClient</Value>
                        </AttributeValuePair>
                    </SubConfiguration>
                </SubConfiguration>
                <SubConfiguration name="globalScripts" id="globalScripts">
                    <SubConfiguration name="9de3eb62-f131-4fac-a294-7bd170fd4acb" id="globalScript">
                        <AttributeValuePair>
                            <Attribute name="name"/>
                            <Value>Scripted Policy Condition</Value>
                        </AttributeValuePair>
                        <AttributeValuePair>
                            <Attribute name="description"/>
                            <Value>Default global script for Scripted Policy Conditions</Value>
                        </AttributeValuePair>
                        <AttributeValuePair>
                            <Attribute name="context"/>
                            <Value>POLICY_CONDITION</Value>
                        </AttributeValuePair>
                        <AttributeValueFromResources>
                            <Attribute name="script"/>
                            <ValueFromResources>
                                <Resource>scripts/policy-condition.js</Resource>
                            </ValueFromResources>
                        </AttributeValueFromResources>
                    </SubConfiguration>
                    <SubConfiguration name="7e3d7067-d50f-4674-8c76-a3e13a810c33" id="globalScript">
                        <AttributeValuePair>
                            <Attribute name="name"/>
                            <Value>Scripted Module - Server Side</Value>
                        </AttributeValuePair>
                        <AttributeValuePair>
                            <Attribute name="description"/>
                            <Value>Default global script for server side Scripted Authentication Module</Value>
                        </AttributeValuePair>
                        <AttributeValuePair>
                            <Attribute name="context"/>
                            <Value>AUTHENTICATION_SERVER_SIDE</Value>
                        </AttributeValuePair>
                        <AttributeValueFromResources>
                            <Attribute name="script"/>
                            <ValueFromResources>
                                <Resource>scripts/authentication-server-side.js</Resource>
                            </ValueFromResources>
                        </AttributeValueFromResources>
                    </SubConfiguration>
                    <SubConfiguration name="c827d2b4-3608-4693-868e-bbcf86bd87c7" id="globalScript">
                        <AttributeValuePair>
                            <Attribute name="name"/>
                            <Value>Scripted Module - Client Side</Value>
                        </AttributeValuePair>
                        <AttributeValuePair>
                            <Attribute name="description"/>
                            <Value>Default global script for client side Scripted Authentication Module</Value>
                        </AttributeValuePair>
                        <AttributeValuePair>
                            <Attribute name="context"/>
                            <Value>AUTHENTICATION_CLIENT_SIDE</Value>
                        </AttributeValuePair>
                        <AttributeValueFromResources>
                            <Attribute name="script"/>
                            <ValueFromResources>
                                <Resource>scripts/authentication-client-side.js</Resource>
                            </ValueFromResources>
                        </AttributeValueFromResources>
                    </SubConfiguration>
                    <SubConfiguration name="703dab1a-1921-4981-98dd-b8e5349d8548" id="globalScript">
                        <AttributeValuePair>
                            <Attribute name="name"/>
                            <Value>Device Id (Match) - Server Side</Value>
                        </AttributeValuePair>
                        <AttributeValuePair>
                            <Attribute name="description"/>
                            <Value>Default global script for server side Device Id (Match) Authentication Module</Value>
                        </AttributeValuePair>
                        <AttributeValuePair>
                            <Attribute name="context"/>
                            <Value>AUTHENTICATION_SERVER_SIDE</Value>
                        </AttributeValuePair>
                        <AttributeValueFromResources>
                            <Attribute name="script"/>
                            <ValueFromResources>
                                <Resource>scripts/deviceIdMatch-server-side.js</Resource>
                            </ValueFromResources>
                        </AttributeValueFromResources>
                    </SubConfiguration>
                    <SubConfiguration name="157298c0-7d31-4059-a95b-eeb08473b7e5" id="globalScript">
                        <AttributeValuePair>
                            <Attribute name="name"/>
                            <Value>Device Id (Match) - Client Side</Value>
                        </AttributeValuePair>
                        <AttributeValuePair>
                            <Attribute name="description"/>
                            <Value>Default global script for client side Device Id (Match) Authentication Module</Value>
                        </AttributeValuePair>
                        <AttributeValuePair>
                            <Attribute name="context"/>
                            <Value>AUTHENTICATION_CLIENT_SIDE</Value>
                        </AttributeValuePair>
                        <AttributeValueFromResources>
                            <Attribute name="script"/>
                            <ValueFromResources>
                                <Resource>scripts/fontdetector.js</Resource>
                                <Resource>scripts/deviceIdMatch-client-side.js</Resource>
                            </ValueFromResources>
                        </AttributeValueFromResources>
                    </SubConfiguration>
                    <SubConfiguration name="36863ffb-40ec-48b9-94b1-9a99f71cc3b5" id="globalScript">
                        <AttributeValuePair>
                            <Attribute name="name"/>
                            <Value>OIDC Claims Script</Value>
                        </AttributeValuePair>
                        <AttributeValuePair>
                            <Attribute name="description"/>
                            <Value>Default global script for OIDC claims</Value>
                        </AttributeValuePair>
                        <AttributeValuePair>
                            <Attribute name="context"/>
                            <Value>OIDC_CLAIMS</Value>
                        </AttributeValuePair>
                        <AttributeValuePair>
                            <Attribute name="language"/>
                            <Value>GROOVY</Value>
                        </AttributeValuePair>
                        <AttributeValueFromResources>
                            <Attribute name="script"/>
                            <ValueFromResources>
                                <Resource>scripts/oidc-claims-extension.groovy</Resource>
                            </ValueFromResources>
                        </AttributeValueFromResources>
                    </SubConfiguration>
                    <SubConfiguration name="01e1a3c0-038b-4c16-956a-6c9d89328cff" id="globalScript">
                        <AttributeValuePair>
                            <Attribute name="name"/>
                            <Value>Authentication Tree Decision Node Script</Value>
                        </AttributeValuePair>
                        <AttributeValuePair>
                            <Attribute name="description"/>
                            <Value>Default global script for a scripted decision node</Value>
                        </AttributeValuePair>
                        <AttributeValuePair>
                            <Attribute name="context"/>
                            <Value>AUTHENTICATION_TREE_DECISION_NODE</Value>
                        </AttributeValuePair>
                        <AttributeValueFromResources>
                            <Attribute name="script"/>
                            <ValueFromResources>
                                <Resource>scripts/authentication-tree-decision-node.js</Resource>
                            </ValueFromResources>
                        </AttributeValueFromResources>
                    </SubConfiguration>
                    <SubConfiguration name="d22f9a0c-426a-4466-b95e-d0f125b0d5fa" id="globalScript">
                        <AttributeValuePair>
                            <Attribute name="name"/>
                            <Value>OAuth2 Access Token Modification Script</Value>
                        </AttributeValuePair>
                        <AttributeValuePair>
                            <Attribute name="description"/>
                            <Value>Default global script for OAuth2 Access Token Modification</Value>
                        </AttributeValuePair>
                        <AttributeValuePair>
                            <Attribute name="context"/>
                            <Value>OAUTH2_ACCESS_TOKEN_MODIFICATION</Value>
                        </AttributeValuePair>
                        <AttributeValuePair>
                            <Attribute name="language"/>
                            <Value>GROOVY</Value>
                        </AttributeValuePair>
                        <AttributeValueFromResources>
                            <Attribute name="script"/>
                            <ValueFromResources>
                                <Resource>scripts/oauth2-access-token-modification.groovy</Resource>
                            </ValueFromResources>
                        </AttributeValueFromResources>
                    </SubConfiguration>
                </SubConfiguration>
            </GlobalConfiguration>
        </Configuration>

    </Service>
</ServicesConfiguration>
